# Prefetch Demos

è¿™é‡ŒåŒ…å«äº†é¢„è¯·æ±‚åŠŸèƒ½çš„å®Œæ•´æ¼”ç¤ºé¡¹ç›®ï¼Œå±•ç¤ºå¦‚ä½•åœ¨ä¸åŒçš„å‰ç«¯æ¡†æ¶ä¸­é›†æˆå’Œä½¿ç”¨é¢„è¯·æ±‚åŠŸèƒ½ã€‚

## é¡¹ç›®ç»“æ„

```
demos/
â”œâ”€â”€ api-server/           # ç‹¬ç«‹çš„ API æœåŠ¡å™¨
â”œâ”€â”€ vite-prefetch-demo/   # Vite + TypeScript æ¼”ç¤º
â”œâ”€â”€ nextjs-prefetch-demo/ # Next.js + TypeScript æ¼”ç¤º
â””â”€â”€ package.json          # ç»Ÿä¸€ç®¡ç†è„šæœ¬
```

## å¿«é€Ÿå¼€å§‹

### ä¸€é”®å®‰è£…æ‰€æœ‰ä¾èµ–

```bash
npm run install:all
```

### å¤åˆ¶ Service Worker æ–‡ä»¶

```bash
npm run copy-sw:all
```

### å¯åŠ¨æ¼”ç¤ºé¡¹ç›®

```bash
# å¯åŠ¨ Vite æ¼”ç¤º (API + Vite)
npm run start:vite

# å¯åŠ¨ Next.js æ¼”ç¤º (API + Next.js)  
npm run start:nextjs

# åŒæ—¶å¯åŠ¨æ‰€æœ‰æ¼”ç¤º (API + Vite + Next.js)
npm run start:all
```

## è®¿é—®åœ°å€

å¯åŠ¨åå¯ä»¥é€šè¿‡ä»¥ä¸‹åœ°å€è®¿é—®ï¼š

- **API æœåŠ¡å™¨**: http://localhost:3001
- **Vite æ¼”ç¤º**: http://localhost:5173
- **Next.js æ¼”ç¤º**: http://localhost:3000

## æ¼”ç¤ºé¡¹ç›®

### ğŸš€ API Server

ç‹¬ç«‹çš„æ¨¡æ‹Ÿ API æœåŠ¡å™¨ï¼Œä¸ºæ‰€æœ‰æ¼”ç¤ºé¡¹ç›®æä¾›æ•°æ®ã€‚

**ç‰¹æ€§**:
- é¢„è¯·æ±‚å¤´è¯†åˆ«å’Œå¤„ç†
- æ™ºèƒ½å»¶è¿Ÿæ¨¡æ‹Ÿ
- å®æ—¶ç»Ÿè®¡ç›‘æ§
- è¯¦ç»†çš„å½©è‰²æ—¥å¿—
- CORS è·¨åŸŸæ”¯æŒ

**ç«¯ç‚¹**:
- `/api/products/1` - äº§å“ä¿¡æ¯
- `/api/products/2` - äº§å“è¯„è®º
- `/api/cart` - è´­ç‰©è½¦æ•°æ®
- `/api/user/profile` - ç”¨æˆ·èµ„æ–™
- `/api/categories` - å•†å“åˆ†ç±»
- `/health` - å¥åº·æ£€æŸ¥
- `/api/stats` - ç»Ÿè®¡ä¿¡æ¯

### âš¡ Vite Demo

åŸºäº Vite + TypeScript çš„é¢„è¯·æ±‚æ¼”ç¤ºã€‚

**ç‰¹æ€§**:
- ç°ä»£åŒ–çš„å¼€å‘ä½“éªŒ
- å¿«é€Ÿçƒ­é‡è½½
- TypeScript æ”¯æŒ
- æ‚¬åœé¢„è¯·æ±‚æ¼”ç¤º
- Service Worker é›†æˆ

**å¯åŠ¨**:
```bash
npm run start:vite
```

### ğŸ”¥ Next.js Demo

åŸºäº Next.js 14 + App Router çš„é¢„è¯·æ±‚æ¼”ç¤ºã€‚

**ç‰¹æ€§**:
- Next.js App Router
- æœåŠ¡ç«¯æ¸²æŸ“æ”¯æŒ
- Tailwind CSS æ ·å¼
- å“åº”å¼è®¾è®¡
- å¤šé¡µé¢é¢„è¯·æ±‚æ¼”ç¤º

**å¯åŠ¨**:
```bash
npm run start:nextjs
```

## å¼€å‘å·¥ä½œæµ

### 1. é¦–æ¬¡è®¾ç½®

```bash
# å…‹éš†ä»“åº“åè¿è¡Œ
npm run install:all
npm run copy-sw:all
```

### 2. å¼€å‘è°ƒè¯•

```bash
# å¯åŠ¨æŒ‡å®šæ¼”ç¤º
npm run start:vite     # æˆ– start:nextjs

# æŸ¥çœ‹ API ç»Ÿè®¡
curl http://localhost:3001/api/stats

# æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€
curl http://localhost:3001/health
```

### 3. æ„å»ºé¡¹ç›®

```bash
# æ„å»ºæ‰€æœ‰æ¼”ç¤ºé¡¹ç›®
npm run build:all

# æ„å»ºæŒ‡å®šé¡¹ç›®
npm run build:vite
npm run build:nextjs
```

## é¢„è¯·æ±‚æ¼”ç¤ºåŠŸèƒ½

### ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

1. **æ‚¬åœé¢„è¯·æ±‚**: é¼ æ ‡æ‚¬åœåœ¨é“¾æ¥ä¸Šè‡ªåŠ¨è§¦å‘é¢„è¯·æ±‚
2. **æ‰‹åŠ¨é¢„è¯·æ±‚**: ç‚¹å‡»æŒ‰é’®æ‰‹åŠ¨è§¦å‘é¢„è¯·æ±‚
3. **çŠ¶æ€ç›‘æ§**: å®æ—¶æ˜¾ç¤º Service Worker çŠ¶æ€
4. **æ€§èƒ½å¯¹æ¯”**: é¢„è¯·æ±‚ vs æ­£å¸¸è¯·æ±‚çš„æ€§èƒ½å·®å¼‚
5. **ç½‘ç»œç›‘æ§**: åœ¨å¼€å‘è€…å·¥å…·ä¸­è§‚å¯Ÿç½‘ç»œæ´»åŠ¨

### ğŸ” æµ‹è¯•åœºæ™¯

1. **äº§å“è¯¦æƒ…é¡µ**: é¢„è¯·æ±‚å•†å“ä¿¡æ¯å’Œè¯„è®ºæ•°æ®
2. **è´­ç‰©è½¦é¡µé¢**: é¢„è¯·æ±‚è´­ç‰©è½¦å†…å®¹
3. **ç”¨æˆ·èµ„æ–™é¡µ**: é¢„è¯·æ±‚ç”¨æˆ·ä¸ªäººä¿¡æ¯
4. **åˆ†ç±»æµè§ˆ**: é¢„è¯·æ±‚åˆ†ç±»å’Œæ¨èæ•°æ®

### ğŸ“Š æ€§èƒ½ç›‘æ§

- **API ç»Ÿè®¡**: è®¿é—® http://localhost:3001/api/stats
- **æµè§ˆå™¨å·¥å…·**: æ‰“å¼€å¼€å‘è€…å·¥å…·æŸ¥çœ‹ç½‘ç»œå’Œæ§åˆ¶å°
- **å®æ—¶æ—¥å¿—**: API æœåŠ¡å™¨æä¾›å½©è‰²æ—¥å¿—è¾“å‡º

## æ•…éšœæ’é™¤

### ç«¯å£å†²çª

å¦‚æœé‡åˆ°ç«¯å£å†²çªï¼Œå¯ä»¥ä¿®æ”¹ä»¥ä¸‹æ–‡ä»¶ï¼š

- API æœåŠ¡å™¨: `api-server/index.js` ä¸­çš„ `port` å˜é‡
- Vite: `vite-prefetch-demo/vite.config.ts` 
- Next.js: `next.config.js` ä¸­çš„ç«¯å£é…ç½®

### Service Worker é—®é¢˜

```bash
# é‡æ–°å¤åˆ¶ Service Worker æ–‡ä»¶
npm run copy-sw:all

# æˆ–å•ç‹¬å¤åˆ¶
npm run copy-sw:vite
npm run copy-sw:nextjs
```

### ä¾èµ–é—®é¢˜

```bash
# é‡æ–°å®‰è£…æ‰€æœ‰ä¾èµ–
npm run install:all

# æˆ–å•ç‹¬å®‰è£…
npm run install:api
npm run install:vite  
npm run install:nextjs
```

## å¼€å‘è€…æç¤º

### ä¿®æ”¹ API æ•°æ®

ç¼–è¾‘ `api-server/index.js` ä¸­çš„ `apiData` å¯¹è±¡æ¥ä¿®æ”¹æ¨¡æ‹Ÿæ•°æ®ã€‚

### è°ƒæ•´å»¶è¿Ÿè®¾ç½®

åœ¨ `api-server/index.js` ä¸­ä¿®æ”¹å»¶è¿Ÿé€»è¾‘ï¼š

```javascript
// å¿«é€Ÿæ¨¡å¼
const delay = isPrefetch ? 10 : 50;

// æ…¢é€Ÿæ¨¡å¼  
const delay = isPrefetch ? 200 : 1000;
```

### æ·»åŠ æ–°çš„æ¼”ç¤ºé¡µé¢

1. åœ¨å¯¹åº”çš„ demo é¡¹ç›®ä¸­æ·»åŠ æ–°é¡µé¢
2. åœ¨ API æœåŠ¡å™¨ä¸­æ·»åŠ å¯¹åº”çš„æ•°æ®ç«¯ç‚¹
3. æ›´æ–°ç›¸å…³çš„è·¯ç”±å’Œé“¾æ¥

## è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. æ¨é€åˆ°åˆ†æ”¯
5. åˆ›å»º Pull Request

## è®¸å¯è¯

ISC License
